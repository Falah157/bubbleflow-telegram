{
  "verses": [
    {
      "id": 1,
      "arabic": "ÙˆÙÙ‚ÙÙ„Ù Ø§Ø¹Ù’Ù…ÙÙ„ÙÙˆØ§ ÙÙØ³ÙÙŠÙØ±ÙÙ‰ Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø¹ÙÙ…ÙÙ„ÙÙƒÙÙ…Ù’ ÙˆÙØ±ÙØ³ÙÙˆÙ„ÙÙ‡Ù ÙˆÙØ§Ù„Ù’Ù…ÙØ¤Ù’Ù…ÙÙ†ÙÙˆÙ†Ù",
      "translation": "And say, 'Do [good] deeds, for Allah will see your deeds, and His Messenger and the believers as well.'",
      "reference": "Quran 9:105",
      "theme": "work"
    },
    {
      "id": 2,
      "arabic": "Ø¥ÙÙ†ÙÙ‘ Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ù„ÙØ§ ÙŠÙØºÙÙŠÙÙ‘Ø±Ù Ù…ÙØ§ Ø¨ÙÙ‚ÙÙˆÙ’Ù…Ù Ø­ÙØªÙÙ‘Ù‰ ÙŠÙØºÙÙŠÙÙ‘Ø±ÙÙˆØ§ Ù…ÙØ§ Ø¨ÙØ£ÙÙ†Ù’ÙÙØ³ÙÙ‡ÙÙ…Ù’",
      "translation": "Indeed, Allah will not change the condition of a people until they change what is in themselves.",
      "reference": "Quran 13:11",
      "theme": "change"
    },
    {
      "id": 3,
      "arabic": "ÙˆÙØªÙØ¹ÙØ§ÙˆÙÙ†ÙÙˆØ§ Ø¹ÙÙ„ÙÙ‰ Ø§Ù„Ù’Ø¨ÙØ±ÙÙ‘ ÙˆÙØ§Ù„ØªÙÙ‘Ù‚Ù’ÙˆÙÙ‰ ÙˆÙÙ„ÙØ§ ØªÙØ¹ÙØ§ÙˆÙÙ†ÙÙˆØ§ Ø¹ÙÙ„ÙÙ‰ Ø§Ù„Ù’Ø¥ÙØ«Ù’Ù…Ù ÙˆÙØ§Ù„Ù’Ø¹ÙØ¯Ù’ÙˆÙØ§Ù†Ù",
      "translation": "And cooperate in righteousness and piety, but do not cooperate in sin and aggression.",
      "reference": "Quran 5:2",
      "theme": "cooperation"
    },
    {
      "id": 4,
      "arabic": "ÙÙØ¥ÙØ°ÙØ§ Ù‚ÙØ¶ÙÙŠÙØªÙ Ø§Ù„ØµÙÙ‘Ù„ÙØ§Ø©Ù ÙÙØ§Ù†ØªÙØ´ÙØ±ÙÙˆØ§ ÙÙÙŠ Ø§Ù„Ù’Ø£ÙØ±Ù’Ø¶Ù ÙˆÙØ§Ø¨Ù’ØªÙØºÙÙˆØ§ Ù…ÙÙ† ÙÙØ¶Ù’Ù„Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù",
      "translation": "And when the prayer has been concluded, disperse within the land and seek from the bounty of Allah.",
      "reference": "Quran 62:10",
      "theme": "sustenance"
    },
    {
      "id": 5,
      "arabic": "ÙˆÙØ§Ù„Ù„ÙÙ‘Ù‡Ù ÙÙØ¶ÙÙ‘Ù„Ù Ø¨ÙØ¹Ù’Ø¶ÙÙƒÙÙ…Ù’ Ø¹ÙÙ„ÙÙ‰ Ø¨ÙØ¹Ù’Ø¶Ù ÙÙÙŠ Ø§Ù„Ø±ÙÙ‘Ø²Ù’Ù‚Ù",
      "translation": "And Allah has favored some of you over others in provision.",
      "reference": "Quran 16:71",
      "theme": "provision"
    }
  ]
}<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanditheemu Project Assistant</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Header with Date & Project Info -->
        <header class="header">
            <div class="project-info">
                <h1><i class="fas fa-road"></i> Kanditheemu Road Project</h1>
                <p id="current-date">Loading date...</p>
                <p class="location"><i class="fas fa-map-marker-alt"></i> Sh. Kanditheemu Island</p>
            </div>
        </header>

        <!-- Daily Quran Reminder Section -->
        <section class="quran-section" id="quran-section">
            <div class="section-title">
                <i class="fas fa-quran"></i> Today's Quran Reminder
            </div>
            <div class="verse-card">
                <div class="verse-arabic" id="verse-arabic">ÙˆÙØ£ÙÙ†Ù’ Ù„ÙÙŠÙ’Ø³Ù Ù„ÙÙ„Ù’Ø¥ÙÙ†Ù’Ø³ÙØ§Ù†Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ù…ÙØ§ Ø³ÙØ¹ÙÙ‰</div>
                <div class="verse-translation" id="verse-translation">
                    "And that there is not for man except that [good] for which he strives"
                </div>
                <div class="verse-reference" id="verse-reference">Quran 53:39</div>
                <button class="btn-secondary" onclick="loadRandomVerse()">
                    <i class="fas fa-sync"></i> New Verse
                </button>
            </div>
        </section>

        <!-- Quick Actions -->
        <section class="actions-section">
            <div class="section-title">
                <i class="fas fa-tasks"></i> Daily Work Log
            </div>
            <div class="actions-grid">
                <button class="action-btn" onclick="openForm('progress')">
                    <i class="fas fa-hard-hat"></i>
                    <span>Site Progress</span>
                </button>
                <button class="action-btn" onclick="openForm('materials')">
                    <i class="fas fa-truck-loading"></i>
                    <span>Material Delivery</span>
                </button>
                <button class="action-btn" onclick="openForm('issues')">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Report Issue</span>
                </button>
                <button class="action-btn" onclick="openCamera()">
                    <i class="fas fa-camera"></i>
                    <span>Site Photo</span>
                </button>
            </div>
        </section>

        <!-- Forms (Hidden by default) -->
        <div id="forms-container">
            <!-- Site Progress Form -->
            <div class="form-card" id="progress-form" style="display: none;">
                <h3><i class="fas fa-hard-hat"></i> Daily Site Progress</h3>
                <div class="form-group">
                    <label>Work Done Today</label>
                    <textarea id="work-done" placeholder="E.g.: Laid 50m road base near market, installed 3 culverts..."></textarea>
                </div>
                <div class="form-group">
                    <label>Number of Workers</label>
                    <input type="number" id="worker-count" placeholder="12">
                </div>
                <div class="form-group">
                    <label>Weather Condition</label>
                    <select id="weather">
                        <option value="sunny">Sunny</option>
                        <option value="partly-cloudy">Partly Cloudy</option>
                        <option value="rainy">Rainy</option>
                        <option value="windy">Windy</option>
                    </select>
                </div>
                <div class="form-buttons">
                    <button class="btn-cancel" onclick="closeForm('progress')">Cancel</button>
                    <button class="btn-primary" onclick="saveProgress()">Save Log</button>
                </div>
            </div>

            <!-- Material Delivery Form -->
            <div class="form-card" id="materials-form" style="display: none;">
                <h3><i class="fas fa-truck-loading"></i> Material Delivery</h3>
                <div class="form-group">
                    <label>Material Type</label>
                    <select id="material-type">
                        <option value="cement">Cement (50kg bags)</option>
                        <option value="gravel">Gravel (tons)</option>
                        <option value="sand">Sand (cubic meters)</option>
                        <option value="pipes">Drainage Pipes</option>
                        <option value="asphalt">Asphalt</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Quantity</label>
                    <input type="number" id="material-qty" placeholder="e.g., 100">
                </div>
                <div class="form-group">
                    <label>Supplier/Driver Name</label>
                    <input type="text" id="supplier" placeholder="e.g., Hassan Construction">
                </div>
                <div class="form-buttons">
                    <button class="btn-cancel" onclick="closeForm('materials')">Cancel</button>
                    <button class="btn-primary" onclick="saveMaterial()">Record Delivery</button>
                </div>
            </div>

            <!-- Issue Report Form -->
            <div class="form-card" id="issues-form" style="display: none;">
                <h3><i class="fas fa-exclamation-triangle"></i> Report Issue</h3>
                <div class="form-group">
                    <label>Issue Type</label>
                    <select id="issue-type">
                        <option value="delay">Work Delay</option>
                        <option value="material-shortage">Material Shortage</option>
                        <option value="safety">Safety Concern</option>
                        <option value="weather">Weather Problem</option>
                        <option value="equipment">Equipment Failure</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="issue-desc" placeholder="Describe the issue in detail..."></textarea>
                </div>
                <div class="form-group">
                    <label>Urgency Level</label>
                    <select id="urgency">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="critical">Critical - Needs Immediate Attention</option>
                    </select>
                </div>
                <div class="form-buttons">
                    <button class="btn-cancel" onclick="closeForm('issues')">Cancel</button>
                    <button class="btn-primary" onclick="saveIssue()">Report Issue</button>
                </div>
            </div>
        </div>

        <!-- Reports Summary -->
        <section class="reports-section">
            <div class="section-title">
                <i class="fas fa-clipboard-list"></i> Today's Entries
            </div>
            <div class="reports-list" id="reports-list">
                <div class="empty-state">
                    <i class="fas fa-clipboard"></i>
                    <p>No entries yet today. Start logging your work!</p>
                </div>
            </div>
            <button class="btn-secondary" onclick="viewWeeklySummary()">
                <i class="fas fa-chart-bar"></i> View Weekly Summary
            </button>
        </section>

        <!-- Footer with Islamic Date -->
        <footer class="footer">
            <div class="hijri-date" id="hijri-date">Hijri Date: Loading...</div>
            <p class="dua">Ø±ÙØ¨ÙÙ‘ Ø²ÙØ¯Ù’Ù†ÙÙŠ Ø¹ÙÙ„Ù’Ù…Ù‹Ø§<br>"My Lord, increase me in knowledge." (Quran 20:114)</p>
            <p class="app-info">Kanditheemu Project Assistant v1.0</p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
/* Reset & Base */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
    background: linear-gradient(135deg, #1a5f7a 0%, #159895 100%);
    color: #333;
    min-height: 100vh;
    padding: 10px;
}

.container {
    max-width: 500px;
    margin: 0 auto;
    background: #f8f9fa;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    overflow: hidden;
}

/* Header */
.header {
    background: linear-gradient(to right, #159895, #1a5f7a);
    color: white;
    padding: 20px;
    text-align: center;
}

.project-info h1 {
    font-size: 1.5rem;
    margin-bottom: 5px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.project-info h1 i {
    color: #57C5B6;
}

#current-date {
    font-size: 0.9rem;
    opacity: 0.9;
}

.location {
    font-size: 0.9rem;
    margin-top: 5px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
}

/* Sections */
section {
    padding: 20px;
    border-bottom: 1px solid #eaeaea;
}

.section-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: #1a5f7a;
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
}

/* Quran Section */
.verse-card {
    background: white;
    border-radius: 15px;
    padding: 20px;
    box-shadow: 0 5px 15px rgba(26, 95, 122, 0.1);
    text-align: center;
    border-left: 5px solid #57C5B6;
}

.verse-arabic {
    font-size: 1.8rem;
    font-family: 'Traditional Arabic', 'Scheherazade', serif;
    color: #1a5f7a;
    margin-bottom: 15px;
    line-height: 1.6;
}

.verse-translation {
    font-size: 1rem;
    color: #555;
    font-style: italic;
    margin-bottom: 10px;
    line-height: 1.5;
}

.verse-reference {
    font-size: 0.9rem;
    color: #159895;
    font-weight: 600;
    margin-bottom: 15px;
}

/* Actions Grid */
.actions-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
}

.action-btn {
    background: white;
    border: none;
    border-radius: 12px;
    padding: 20px 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.08);
    transition: all 0.3s ease;
    cursor: pointer;
}

.action-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
}

.action-btn i {
    font-size: 1.8rem;
    color: #1a5f7a;
}

.action-btn span {
    font-size: 0.9rem;
    font-weight: 600;
    color: #333;
}

/* Forms */
.form-card {
    background: white;
    border-radius: 15px;
    padding: 20px;
    margin: 20px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    animation: slideIn 0.3s ease;
}

@keyframes slideIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1a5f7a;
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid #ddd;
    border-radius: 10px;
    font-size: 1rem;
    transition: border 0.3s;
}

.form-group textarea {
    min-height: 100px;
    resize: vertical;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #57C5B6;
    box-shadow: 0 0 0 3px rgba(87, 197, 182, 0.2);
}

.form-buttons {
    display: flex;
    gap: 15px;
    margin-top: 25px;
}

/* Buttons */
.btn-primary {
    flex: 1;
    background: linear-gradient(to right, #159895, #1a5f7a);
    color: white;
    border: none;
    padding: 15px;
    border-radius: 10px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

.btn-primary:hover {
    opacity: 0.9;
    transform: scale(1.02);
}

.btn-secondary {
    background: white;
    color: #1a5f7a;
    border: 2px solid #1a5f7a;
    padding: 12px 20px;
    border-radius: 10px;
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.3s;
    width: 100%;
    margin-top: 10px;
}

.btn-secondary:hover {
    background: #1a5f7a;
    color: white;
}

.btn-cancel {
    flex: 1;
    background: #f1f1f1;
    color: #666;
    border: none;
    padding: 15px;
    border-radius: 10px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
}

.btn-cancel:hover {
    background: #e0e0e0;
}

/* Reports List */
.reports-list {
    background: white;
    border-radius: 15px;
    padding: 15px;
    min-height: 100px;
    margin-bottom: 15px;
}

.report-item {
    background: #f8f9fa;
    border-left: 4px solid #57C5B6;
    padding: 12px 15px;
    margin-bottom: 10px;
    border-radius: 8px;
    font-size: 0.9rem;
}

.report-item .report-type {
    font-weight: bold;
    color: #1a5f7a;
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 5px;
}

.empty-state {
    text-align: center;
    padding: 30px 20px;
    color: #888;
}

.empty-state i {
    font-size: 2.5rem;
    color: #ccc;
    margin-bottom: 15px;
}

/* Footer */
.footer {
    padding: 20px;
    text-align: center;
    background: #f1f1f1;
    color: #555;
}

.hijri-date {
    font-weight: 600;
    color: #1a5f7a;
    margin-bottom: 10px;
}

.dua {
    font-size: 1rem;
    font-style: italic;
    margin: 15px 0;
    color: #159895;
    line-height: 1.5;
}

.app-info {
    font-size: 0.8rem;
    color: #888;
    margin-top: 15px;
}

/* Responsive */
@media (max-width: 480px) {
    .container {
        border-radius: 15px;
    }
    
    .header, section {
        padding: 15px;
    }
    
    .actions-grid {
        grid-template-columns: 1fr;
    }
    
    .form-card {
        margin: 10px;
    }
}
// Telegram WebApp Integration
const tg = window.Telegram.WebApp;

// Initialize Telegram WebApp
tg.expand();
tg.setHeaderColor('#1a5f7a');
tg.setBackgroundColor('#f8f9fa');

// State
let today = new Date();
let dailyEntries = [];
let verses = [];

// DOM Elements
const verseArabic = document.getElementById('verse-arabic');
const verseTranslation = document.getElementById('verse-translation');
const verseReference = document.getElementById('verse-reference');
const currentDateElement = document.getElementById('current-date');
const hijriDateElement = document.getElementById('hijri-date');
const reportsList = document.getElementById('reports-list');

// Initialize Date
function updateDate() {
    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    currentDateElement.textContent = today.toLocaleDateString('en-US', options);
    
    // Simple Hijri date (approximation - for real implementation use a library)
    const hijri = new Intl.DateTimeFormat('en-US-u-ca-islamic', {day: 'numeric', month: 'long', year: 'numeric'}).format(today);
    hijriDateElement.textContent = `Hijri: ${hijri}`;
}

// Load Quran Verses
async function loadVerses() {
    try {
        const response = await fetch('verses.json');
        const data = await response.json();
        verses = data.verses;
        loadRandomVerse();
    } catch (error) {
        console.error('Error loading verses:', error);
        // Fallback verses
        verses = [
            {
                arabic: "ÙˆÙÙ‚ÙÙ„Ù Ø§Ø¹Ù’Ù…ÙÙ„ÙÙˆØ§ ÙÙØ³ÙÙŠÙØ±ÙÙ‰ Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø¹ÙÙ…ÙÙ„ÙÙƒÙÙ…Ù’",
                translation: "And say, 'Do deeds, for Allah will see your deeds.'",
                reference: "Quran 9:105",
                theme: "work"
            }
        ];
        loadRandomVerse();
    }
}

// Show Random Verse
function loadRandomVerse() {
    if (verses.length === 0) return;
    
    const randomIndex = Math.floor(Math.random() * verses.length);
    const verse = verses[randomIndex];
    
    verseArabic.textContent = verse.arabic;
    verseTranslation.textContent = `"${verse.translation}"`;
    verseReference.textContent = verse.reference;
    
    // Store today's verse in localStorage
    localStorage.setItem('dailyVerse', JSON.stringify({
        verse: verse,
        date: today.toDateString()
    }));
}

// Form Handling
function openForm(formType) {
    // Hide all forms first
    document.querySelectorAll('.form-card').forEach(form => {
        form.style.display = 'none';
    });
    
    // Show selected form
    document.getElementById(`${formType}-form`).style.display = 'block';
    
    // Scroll to form
    document.getElementById(`${formType}-form`).scrollIntoView({ behavior: 'smooth' });
}

function closeForm(formType) {
    document.getElementById(`${formType}-form`).style.display = 'none';
}

// Save Functions
function saveProgress() {
    const workDone = document.getElementById('work-done').value;
    const workerCount = document.getElementById('worker-count').value;
    const weather = document.getElementById('weather').value;
    
    if (!workDone.trim()) {
        alert('Please describe work done today');
        return;
    }
    
    const entry = {
        id: Date.now(),
        type: 'progress',
        workDone,
        workerCount: workerCount || 'Not specified',
        weather,
        timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
    };
    
    saveEntry(entry);
    document.getElementById('work-done').value = '';
    document.getElementById('worker-count').value = '';
    closeForm('progress');
}

function saveMaterial() {
    const materialType = document.getElementById('material-type').value;
    const quantity = document.getElementById('material-qty').value;
    const supplier = document.getElementById('supplier').value;
    
    if (!quantity || !supplier.trim()) {
        alert('Please fill quantity and supplier');
        return;
    }
    
    const entry = {
        id: Date.now(),
        type: 'material',
        materialType,
        quantity,
        supplier,
        timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
    };
    
    saveEntry(entry);
    document.getElementById('material-qty').value = '';
    document.getElementById('supplier').value = '';
    closeForm('materials');
}

function saveIssue() {
    const issueType = document.getElementById('issue-type').value;
    const description = document.getElementById('issue-desc').value;
    const urgency = document.getElementById('urgency').value;
    
    if (!description.trim()) {
        alert('Please describe the issue');
        return;
    }
    
    const entry = {
        id: Date.now(),
        type: 'issue',
        issueType,
        description,
        urgency,
        timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
    };
    
    saveEntry(entry);
    document.getElementById('issue-desc').value = '';
    closeForm('issues');
}

// Save Entry to Local Storage
function saveEntry(entry) {
    // Load existing entries for today
    let entries = JSON.parse(localStorage.getItem('dailyEntries') || '[]');
    
    // If entries are from a different day, clear them
    const todayStr = today.toDateString();
    const lastEntryDate = localStorage.getItem('lastEntryDate');
    if (lastEntryDate !== todayStr) {
        entries = [];
    }
    
    entries.push(entry);
    localStorage.setItem('dailyEntries', JSON.stringify(entries));
    localStorage.setItem('lastEntryDate', todayStr);
    
    // Update UI
    updateReportsList();
    
    // Show confirmation
    tg.showPopup({
        title: 'âœ… Saved Successfully',
        message: 'Your entry has been saved locally.',
        buttons: [{ type: 'ok' }]
    });
}

// Update Reports List UI
function updateReportsList() {
    const entries = JSON.parse(localStorage.getItem('dailyEntries') || '[]');
    const todayStr = today.toDateString();
    const lastEntryDate = localStorage.getItem('lastEntryDate');
    
    // Clear if not today
    if (lastEntryDate !== todayStr) {
        reportsList.innerHTML = `
            <div class="empty-state">
                <i class="fas fa-clipboard"></i>
                <p>No entries yet today. Start logging your work!</p>
            </div>
        `;
        return;
    }
    
    if (entries.length === 0) {
        reportsList.innerHTML = `
            <div class="empty-state">
                <i class="fas fa-clipboard"></i>
                <p>No entries yet today. Start logging your work!</p>
            </div>
        `;
        return;
    }
    
    let html = '';
    entries.forEach(entry => {
        let icon, title, details;
        
        switch(entry.type) {
            case 'progress':
                icon = 'fas fa-hard-hat';
                title = 'Site Progress';
                details = `${entry.workDone.substring(0, 60)}... â€¢ Workers: ${entry.workerCount} â€¢ ${entry.weather}`;
                break;
            case 'material':
                icon = 'fas fa-truck-loading';
                title = 'Material Delivery';
                details = `${entry.materialType}: ${entry.quantity} units â€¢ From: ${entry.supplier}`;
                break;
            case 'issue':
                icon = 'fas fa-exclamation-triangle';
                title = 'Issue Reported';
                details = `${entry.issueType}: ${entry.description.substring(0, 60)}... â€¢ Urgency: ${entry.urgency}`;
                break;
        }
        
        html += `
            <div class="report-item">
                <div class="report-type">
                    <i class="${icon}"></i> ${title}
                </div>
                <div>${details}</div>
                <div class="report-time">${entry.timestamp}</div>
            </div>
        `;
    });
    
    reportsList.innerHTML = html;
}

// Open Camera (Telegram Mini App feature)
function openCamera() {
    tg.showPopup({
        title: 'Camera Access',
        message: 'In a real implementation, this would open camera for site photos.',
        buttons: [{ type: 'ok' }]
    });
    
    // For real camera access in Telegram Mini App:
    // tg.requestCameraAccess().then(granted => {
    //     if (granted) {
    //         // Use Telegram camera or file picker
    //         tg.showPhotoPicker({}, photos => {
    //             // Handle selected photos
    //         });
    //     }
    // });
}

// View Weekly Summary
function viewWeeklySummary() {
    const entries = JSON.parse(localStorage.getItem('dailyEntries') || '[]');
    
    if (entries.length === 0) {
        tg.showPopup({
            title: 'No Data',
            message: 'No entries found for this week.',
            buttons: [{ type: 'ok' }]
        });
        return;
    }
    
    // Simple summary
    const progressCount = entries.filter(e => e.type === 'progress').length;
    const materialCount = entries.filter(e => e.type === 'material').length;
    const issueCount = entries.filter(e => e.type === 'issue').length;
    
    const summary = `
ğŸ“Š Weekly Summary (Last 7 days):

âœ… Site Progress Logs: ${progressCount}
ğŸ§± Material Deliveries: ${materialCount}
âš ï¸ Issues Reported: ${issueCount}

Total Entries: ${entries.length}
    `.trim();
    
    tg.showPopup({
        title: 'Weekly Summary',
        message: summary,
        buttons: [{ type: 'ok' }]
    });
}

// Export Data (for sending to supervisor)
function exportData() {
    const entries = JSON.parse(localStorage.getItem('dailyEntries') || '[]');
    const dataStr = JSON.stringify(entries, null, 2);
    
    tg.showPopup({
        title: 'Export Data',
        message: 'Data exported. In real app, this would send to supervisor or save as file.',
        buttons: [{ type: 'ok' }]
    });
    
    // For real implementation:
    // tg.sendData(dataStr); // Sends data to bot
}

// Initialize App
function initApp() {
    updateDate();
    loadVerses();
    updateReportsList();
    
    // Check for saved verse for today
    const savedVerse = JSON.parse(localStorage.getItem('dailyVerse') || 'null');
    if (savedVerse && savedVerse.date === today.toDateString()) {
        verseArabic.textContent = savedVerse.verse.arabic;
        verseTranslation.textContent = `"${savedVerse.verse.translation}"`;
        verseReference.textContent = savedVerse.verse.reference;
    }
    
    // Telegram Main Button (for exporting)
    tg.MainButton.setText('ğŸ“¤ Export Today\'s Report');
    tg.MainButton.onClick(exportData);
    tg.MainButton.show();
}

// Start App
document.addEventListener('DOMContentLoaded', initApp);

// Optional: Auto-refresh verse at Fajr time (simplified)
function refreshAtFajr() {
    const now = new Date();
    const hours = now.getHours();
    
    // If between 4 AM and 5 AM (approximate Fajr), refresh verse
    if (hours >= 4 && hours < 5) {
        const lastRefresh = localStorage.getItem('lastVerseRefresh');
        const todayDate = now.toDateString();
        
        if (lastRefresh !== todayDate) {
            loadRandomVerse();
            localStorage.setItem('lastVerseRefresh', todayDate);
        }
    }
}

// Check every hour
setInterval(refreshAtFajr, 60 * 60 * 1000);
        
